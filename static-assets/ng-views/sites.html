<!--
  ~ Copyright (C) 2007-2020 Crafter Software Corporation. All Rights Reserved.
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License version 3 as published by
  ~ the Free Software Foundation.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div class="sites-view mainContainer">
  <header class="screen-title mb10">
    <h1>{{ 'dashboard.sites.SITES_LABEL' | translate }}</h1>
  </header>

  <div ng-if="sites">
    <div ng-show="createSites" class="createSitesBtn pull-left mb10">
      <button
        id="create-site"
        class="btn btn-default btn-pill btn-block btn-padded"
        ng-click="createSitesDialog()"
        ng-class="{ active: $state.includes('create') }"
      >
        <i class="fa fa-plus-circle mr5"></i>
        <span>{{ 'dashboard.sites.CREATE_SITE' | translate }}</span>
      </button>
    </div>
    <div ui-view>
      <table class="site-list table table-hover">
        <thead>
          <tr>
            <th><span class="sr-only">{{ 'dashboard.sites.SITE_NAME' | translate }}</span></th>
            <th><span class="sr-only">Site Id</span></th>
            <th><span class="sr-only">{{ 'common.EDIT' | translate }}</span></th>
            <th><span class="sr-only">{{ 'common.REMOVE_LABEL' | translate }}</span></th>
          </tr>
        </thead>
        <tbody>
          <tr
            id="site-row-{{site.id}}"
            ng-click="editSite(site)"
            dir-paginate="site in sites | filter:q | itemsPerPage: sitesPag.sitesPerPage"
            current-page="pagination"
            total-items="totalSites"
            style="cursor: pointer"
          >
            <td class="name site-name trim" title="{{site.name ? site.name : site.id}}">
              <a ng-click="editSite(site)">{{site.name ? site.name : site.id}} &raquo;</a>
              <div
                ng-if="site.description"
                ng-bind="site.description"
                ng-attr-title="{{site.description}}"
                style="overflow: hidden; text-overflow: ellipsis"
              ></div>
            </td>
            <td class="name site-name trim">
              <div
                ng-bind="site.id"
                ng-attr-title="{{site.id}}"
                style="overflow: hidden; text-overflow: ellipsis"
              ></div>
            </td>
            <td class="remove">
              <a
                ng-show="site.edit"
                ng-click="editSiteData(site, $event)"
                class="btn btn-sm"
                tooltip-placement="bottom"
                uib-tooltip="Edit"
              >
                <i class="fa fa-pencil"></i>
              </a>
            </td>
            <td class="remove">
              <a
                ng-show="site.remove"
                ng-click="removeSiteSites(site, $event)"
                class="btn btn-sm"
                tooltip-placement="bottom"
                uib-tooltip="{{'common.REMOVE_LABEL' | translate}}"
              >
                <i class="fa fa-trash-o"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="global-menu-pagination-wrapper">
        <div class="mr10">
          <label class="mr5">{{ 'dashboard.sites.SITES_PER_PAGE' | translate }}: </label>
          <input
            class="audit-number-logs"
            type="number"
            name="input"
            ng-model="sitesPag.sitesPerPage"
            min="0"
            max="500"
            ng-model-options="{debounce: defaultDelay}"
          />
        </div>
        <dir-pagination-controls
          id="sites-pagination"
          class="ml10"
          on-page-change="pageChanged(newPageNumber)"
        ></dir-pagination-controls>
      </div>
    </div>
  </div>

  <div ng-if="(!sites || !sites.length) && !createSites">
    <p class="site-message">{{ 'dashboard.sites.NO_SITES_MESSAGE' | translate }}</p>
  </div>

  <div class="create-site-dialog-container"></div>
</div>

<div ng-show="showLoader" class="showLoader">
  <i class="fa fa-spinner fa-spin fa-3x fa-fw loading"></i>
</div>

<script type="text/ng-template" id="removeConfirmation.html">
  <div id="remove-site">
      <div class="modal-header">
          <h3 class="modal-title">{{ 'common.CONFIRMATION' | translate }}</h3>
      </div>
      <div class="modal-body">
          <p>{{ 'dashboard.sites.REMOVE_SITE_CONFIRMATION_MSG' | translate }} {{siteToRemove}} {{ 'common.INTERROGATION_SIGN' | translate }}</p>
      </div>
      <div class="modal-footer">
          <button class="btn btn-default no" ng-click="cancel()">{{ 'common.NO' | translate }}</button>
          <button class="btn btn-primary yes" ng-disabled="confirmationSubmitDisabled" ng-click="ok()">{{ 'common.YES' | translate }}</button>
      </div>
  </div>
</script>

<script type="text/ng-template" id="invalidSite.html">
  <div class="modal-header">
      <h3 class="modal-title">{{ 'common.NOTIFICATION' | translate }}</h3>
  </div>
  <div class="modal-body">
      <p>"{{siteValidation}}" {{ 'dashboard.sites.SITE_ERROR' | translate }}</p>
  </div>
  <div class="modal-footer">
      <button class="btn btn-default" ng-click="cancel()">{{ 'common.CANCEL' | translate }}</button>
  </div>
</script>

<script type="text/ng-template" id="notificationModal.html">
  <div class="modal-header">
    <h3 class="modal-title">Notification</h3>
  </div>
  <div class="modal-body">
    <p class="notificationBody">
      <span class="icon fa fa-{{ notificationType }}"></span>
      <span class="text"> {{ notificationText }}</span>
    </p>
  </div>
</script>
